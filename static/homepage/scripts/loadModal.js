(function($){$.loadmodal=function(options){if($.type(options)=='string'){options={url:options,};}
options=$.extend(true,{url:null,id:'jquery-loadmodal-js',idBody:'jquery-loadmodal-js-body',appendToSelector:'body',title:window.document.title||'Dialog',width:'400px',dlgClass:'fade',size:'modal-lg',closeButton:true,buttons:{},modal:{},ajax:{url:null,},beforeShow:null,onShow:null,},options);options.ajax.url=options.ajax.url||options.url;if(!options.ajax.url){throw new Error('$().loadmodal requires a url.');}
$('#'+options.id).modal('hide');options.ajax.success=$.isArray(options.ajax.success)?options.ajax.success:options.ajax.success?[options.ajax.success]:[];options.ajax.success.unshift(function(data,status,xhr){if(options.beforeShow&&options.beforeShow(data,status,xhr)===false){return;}
var div=$(['<div id="'+options.id+'" class="modal '+options.dlgClass+' jquery-loadmodal-js">','  <div class="modal-dialog '+options.size+'">','      <div class="modal-content">','        <div class="modal-header">',options.closeButton?'          <button class="close" data-dismiss="modal" type="button">x</button>':'','          <h4 class="modal-title">'+options.title+'</h4>','        </div>','        <div id="'+options.idBody+'" class="modal-body">','        </div>','      </div>','    </div>','  </div>',].join('\n'));$(options.appendToSelector).append(div);div.find('.modal-body').html(data);div.modal(options.modal);div.find('.modal-dialog').css('width',options.width);if(!$.isEmptyObject(options.buttons)){div.find('.modal-body').append('<div class="button-panel"></div>');var button_class='btn btn-primary';$.each(options.buttons,function(key,func){var button=$('<button class="'+button_class+'">'+key+'</button>');div.find('.button-panel').append(button);button.on('click.button-panel',function(evt){var closeDialog=true;if(func&&func(evt)===false){closeDialog=false;}
if(closeDialog){div.modal('hide');}});button_class='btn btn-default';});}
div.on('hidden.bs.modal',function(e){div.removeData();div.remove();});if(options.onShow){options.onShow(div);}});$.ajax(options.ajax);};})(jQuery);